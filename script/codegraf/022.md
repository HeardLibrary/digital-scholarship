---
permalink: /script/codegraf/022/
title: CodeGraf - Reading and writing CSV files
breadcrumb: O21
---

[CodeGraf landing page](../)

[Complex data structures](../021)

# Reading and writing CSV files

If we load

**Learning objectives** At the end of this lesson, the learner will be able to:
- descr

Total video time:  m  s

## Links

[Lesson Jupyter notebook at GitHub](https://github.com/HeardLibrary/digital-scholarship/blob/master/code/codegraf/022/022.ipynb)

[Lesson Colab notebook](https://colab.research.google.com/drive/1pM_sZW_gAbPNKAu)

----

# Text editors and code editors (2m13s)

<iframe width="1120" height="630" src="https://www.youtube.com/embed/RIzK188oW2A" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

----

# CSV reader/writer

## CSV files

An extremely common way to store tabular data is in *fielded text files*, commonly called *"CSV"* (comma separated values) files.  "Fielded text" is probably a better term, because the fields in the text aren't always delimited by commas.  It is also fairly common for fields to be separated by tabs or some other characters.  But it's still common to call them "CSV" files regardless of the delimiter.

A CSV file is simply a text file where the rows are on separate lines terminated by newlines, and the fields (i.e. columns) within the row are separated by commas.  Here's an example:

```
given_name,family_name,username,student_id
Jimmy,Zhang,rastaman27,37258
Ji,Kim,kimji8,44947
Veronica,Fuentes,shakira<3,19846
```

Paste this text into a text editor, then save it as `students.csv`. Alternatively, you can just run this code, which will write the text into a file for you:

```
someText = '''given_name,family_name,username,student_id
Jimmy,Zhang,rastaman27,37258
Ji,Kim,kimji8,44947
Veronica,Fuentes,shakira<3,19846'''
with open('students.csv', 'wt', encoding='utf-8') as fileObject:
    fileObject.write(someText)
```

You can then open the file with a spreadsheet program like Excel, Open Office, or Libre Office.  If you do, it will look something like this:

<img src="../../python/images/open-office-table.png" style="border:1px solid black">

You can also create the CSV file directly in the spreadsheet program, then use Save As... to save it in the CSV format.

**Note:** Although it is convenient to use Excel to work with CSV files since most people have Excel on their computers, if you are going to do serious work with CSV files using Excel is NOT recommended.  The reason for this is that Excel automatically converts some strings that include dashes (typically ID numbers or other codes) into dates when it imports them.  Because CSV files do not contain any metadata describing the format of the files, there is no known way to prevent this problem.  It is a frustrating and insidious problem that can ruin a large dataset in ways that are difficult to repair.  So it is better to install and use Libre Office (open source) or Open Office and use them instead.

When saving a newly-created CSV file, you should use Save As... In Libre or Open Office, there is a checkbox in the dialog where you have the option to Edit Filter Settings.  

<img src="../../python/images/edit-filter-settings.png" style="border:1px solid black">

The subsequent dialog box allows you to select a field delimiter, which will usually default to comma:

<img src="../../python/images/pick-delimiters.png" style="border:1px solid black">

There is also a dropdown where you can select UTF-8 as the file encoding:

<img src="../../python/images/select-utf-8.png" style="border:1px solid black">

If your file contains only ASCII characters (Latin alphabet, numeric, and typical symbol characters), the Edit Filter Settings isn't that critical, but if your text contains any non-Latin language characters, unusual symbols, or letters with diacritics, it's critical to make sure that the file is saved as UTF-8.  

Libre or Open Office tend to assume that you want to use the last delimiter and character encoding that you used previously, so once you have saved a CSV file in this manner, it's usually safe to open and close it by just saving without going through the `Save As...` dialog.



----

# Practice exercises

1. **Dealing cards** Here is some code that generates a deck of cards as a list:

The code after the makeDeck() function shows how the choice() function and the .shuffle() method can be used to randomize the cards in the deck.

a. Use this function to write a script that “deals” a five card poker hand by printing five random cards from the deck. Note that after each card is printed, it has to be removed from the deck so that when the next card is printed, there isn’t any chance that you’ll get the same one a second time.

b. Instead of just printing the five cards, use .append() to add them to another list called hand. Print the whole hand list.

c. Can you figure out how to check for any kind of poker hands? How about a flush?




3. **Latte maker**  Create the latte-making function `makeLatte(beans, milk, extras, water)` described earlier in the exercise.  The function will need to have some complicated `if` statements to check for the kinds of beans, milk, and extras.  You should consider whether you should create additional functions that would be called by the `makeLatte()` function to figure out things about the possible ingredients.  Here are the program parameters:

**Minimum inputs** (you can have more):

| variable | possible string values |
|---|---|
| beans | "decaf", "regular", "dark roast" |
| milk | "whole", "skim", "soy" |
| extras | "none", "pumpkin spice", "vanilla" |
| water | "yes", "no" |

**Required output**:

Print a single string formed by concatenating adjective strings in front of the string "latte".  You can use whatever adjectives you think would work best for marketing, but at a minimum, you should be able to produce "regular non-fat plain latte", "decaf skinny vanilla latte", and "dark fat pumpkin spice latte" (substitute a different adjective for "fat" if you can think of a better euphamism).  If "no" is selected for water, then provide some kind of error message.  
----

Next lesson: [x](../023)

----

Revised 2020-10-15
