# IIIF Collections script

This directory contains a Python script for generating [IIIF Presentation API 3.0 Collections JSON files](https://iiif.io/api/presentation/3.0/#51-collection), [generate_collections_json.py](generate_collections_json.py), as well as associated data files and sample output generated by the script.

## Script details

Script location: <https://github.com/HeardLibrary/digital-scholarship/blob/master/code/iiif/collections/generate_collections_json.py>

Current version: 0.1.0

Written by Steve Baskauf 2023-11-30

Copyright 2023 Vanderbilt University. This program is released under a [GNU General Public License v3.0](http://www.gnu.org/licenses/gpl-3.0).

### RFC 2119 keywords

The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as described in [BCP 14](https://www.rfc-editor.org/info/bcp14) \[[RFC 2119](https://datatracker.ietf.org/doc/html/rfc2119)\] and \[[RFC 8174](https://datatracker.ietf.org/doc/html/rfc8174)\] when, and only when, they appear in all capitals, as shown here.

### Installation requirements

The pandas library is REQUIRED. It is not part of the standard Python library, but is commonly included in distributions such as Anaconda. 

### Command line options

Generally the command line options will not change for a given installation, using them is OPTIONAL if the hard-coded defaults in [lines 54 to 72](https://github.com/HeardLibrary/digital-scholarship/blob/4aa06440486702bc95e518dd4f6c5478c1f5dfcb/code/iiif/collections/generate_collections_json.py#L54C1-L73C1) are changed rather than specifying them on the command line. 

| long form | short form | values | default if omitted |
| --------- | ---------- | ------ | ------- |
| --baseurl | -B | first part of collection JSON URL | `https://iiif-manifest.library.vanderbilt.edu/gallery/collections/` |
| --config | -C | path to configuration file | `collections_config.yml` |
| --datafile | -D | path to CSV file containing manifest data | `manifest_data.csv` |
| --lang | -L | language tag | `en` |
| --version | -V | no values; displays current version information |  |
| --help | -H | no values; displays link to this page |  |

### Configuration file

The [configuration file](collections_config.yml) is a REQUIRED YAML file that contains information specific to the collection. The values in the file MUST be set prior to running the script. The keys in the file are:

| key | information provided by value |
| --- | ----- |
| collection_json_filename | the filename of the output file that will be served on the web; it is appended to the `baseurl` value to form the URL for the IIIF collections JSON . |
| collection_label | a title displayed for the collection of manifests |
| collection_summary | a description of the collection of manifests |
| attribution | an attribution statement for the provider of the collection |

### Data file

The [data file](manifest_data.csv) is a REQUIRED CSV file that contains information about the manifests that will be included in the collection. There MUST be at least one row in the table. The columns in the file are:

| column | information provided by value |
| ------ | ----- |
| manifest_id | the URL of the manifest |
| manifest_label | a title displayed for the manifest |
| thumbnail_id | the URL of the thumbnail image for the manifest |

### Sample output

An example of output produced by the script based on the data included in the configuration and data files is viewable in the [ww1_posters.json](ww1_posters.json) file in this directory. The file is served directly with an `application/json` Content-Type header at <https://iiif-manifest.library.vanderbilt.edu/gallery/collections/ww1_posters.json>.

## Viewing the collection in a IIIF viewer

Support for IIIF Collections is variable among IIIF viewers. 

The most intuitive interface is provided by the [Annonatate viewer](https://annonatate.fly.dev/). NCSU Libraries hosts an instance that can be used to view a collection by inserting the collection URL into the viewer's URL. The example URL has been inserted after the `url=` parameter in the following URL:

<https://ncsu-libraries.github.io/annona/tools/#/display?url=https%3A%2F%2Fiiif-manifest.library.vanderbilt.edu%2Fgallery%2Fcollections%2Fww1_posters.json&viewtype=iiif-storyboard&manifesturl=&settings=%7B%22fullpage%22%3Atrue%7D>

To see the manifests included in the collection along with their thumbnails, click on the "i" button at the upper left, then click on the Collection link in the popup window. To view one of the manifests in the collection, click on the manifest thumbnail image or title. 

[Universal Viewer](https://universalviewer.io/) also supports IIIF Collections, although it sometimes seems to have trouble displaying the thumbnails and does not show them for all of the manifests in the Index tab. 

<https://uv-v3.netlify.app/#?manifest=https://iiif-manifest.library.vanderbilt.edu/gallery/collections/ww1_posters.json>

[Mirador](https://projectmirador.org/) supports IIIF collections, but navigation is through an annoying popup window which does not show the thumbnails for the manifests. 

<https://projectmirador.org/embed/?iiif-content=https://iiif-manifest.library.vanderbilt.edu/gallery/collections/ww1_posters.json>

### Reference links

[IIIF Cookbook: Multi-volume Work with Individually-bound Volumes](https://iiif.io/api/cookbook/recipe/0030-multi-volume/) (see example collection with links)

[IIIF Presentation API Validator](https://presentation-validator.iiif.io/)

-----

Revised 2023-11-30
